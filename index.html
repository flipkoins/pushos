<!DOCTYPE html>
<html lang="en">
<head>
    <title>BookMyLivestock | Notification</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/16.png" type="image/png" sizes="16x16">
<link rel="icon" href="/32.png"  type="image/png" sizes="32x32" />
<style>
@media only screen and (max-width: 375px) {
    #subscribeNow {
       font-size: 48px;
       margin-top:70px;
    }
}
@media only screen and (max-width: 425px) {
    #subscribeNow {
       font-size: 35px;
       padding: 23px 78px;
    }
}
</style>
</head>
<body style="
    text-align: center;
    padding: 40px 10px;
">
    <img src="/android-launchericon-192-192.png" alt="Logo">
<p style="
    /* padding: 0px 70px; */
    margin: auto;
    text-align: center;
    /* margin-top: 50px; */
    line-height: 28px;
    font-size: 18px;
    max-width: 320px;
    /* width: 300px; */
">கால்நடைகளின் தகவல், விலை விவரம், விற்பனை பதிவு போன்றவற்றை தெரிந்து கொள்ள வேண்டுமா? "Enable Notification" என்பதைக் கிளிக் செய்து, பின்னர் "Allow" என்பதை தேர்வு செய்யுங்கள்.</p>
   <button id="subscribeNow" style="
    margin-top: 38px;
    font-size: 19px;
    padding: 13px 50px;
    background: #05a884;
    color: white;
    border: none;
    cursor: pointer;
">Enable Notification</button>
<script>
 function goBack() {
     // Remove current history entry
    history.replaceState(null, '', document.location.href);
  
    // Go back to the previous page
    if(document.referrer.includes('www.bookmylivestock.com')) {
        window.history.go(-1):
    } else {
        document.location.href = "https://www.bookmylivestock.com/ta"
    };
 }
    
  document.getElementById('subscribeNow').addEventListener('click', () => {
      if ("Notification" in window) {
        if (Notification.permission === "granted") {
          console.log("Notifications are enabled");
        } else if (Notification.permission === "default") {
          Notification.requestPermission().then((permission) => {
            if (permission === "granted") {
              window.OneSignalDeferred = window.OneSignalDeferred || [];
                OneSignalDeferred.push(function(OneSignal) {
                  OneSignal.init({
                    appId: "84c7596a-6657-4ac8-9039-aab9f2237940"
                  }).then(() => {
                    console.log("OneSignal initialized successfully.");
                    // Additional tasks after initialization
                    goBack();
                    return OneSignal.getUserId();
                  }).then((userId) => {
                    console.log("User ID:", userId);
                  }).catch((error) => {
                    goBack();
                    console.error("Error initializing OneSignal:", error);
                  });
                });
            } else {
               goBack();
              console.log("User denied permission");
            }
          });
        } else {
          goBack();
          console.log("Notifications are blocked");
        }
      } else {
        goBack();
        console.log(
          "Notifications are not supported on this device or browser."
        );
      }
  });
</script>
</body>
</html>
