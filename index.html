<!DOCTYPE html>
<html lang="en">
<head>
    <title>Push Notification Subscription</title>
</head>
<body>
    <h1>Subscribe to Notifications</h1>
    <button id="subscribeNow">Enable Notifications</button>

    <script>
        document.getElementById('subscribeNow').addEventListener('click', () => {
            // Request notification permissions
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                  window.OneSignalDeferred = window.OneSignalDeferred || [];
                  OneSignalDeferred.push(async function(OneSignal) {
                    await OneSignal.init({
                      appId: "84c7596a-6657-4ac8-9039-aab9f2237940",
                    });
                  });
                  window.opener.postMessage({ action: 'subscriptionSuccess' }, 'https://www.bookmylivestock.com');
                    // navigator.serviceWorker.register('/OneSignalSDKWorker.js')
                    //     .then(() => {
                    //         console.log('Service Worker registered successfully.');

                    //         // Notify the main domain of success
                    //         window.opener.postMessage({ action: 'subscriptionSuccess' }, 'https://www.bookmylivestock.com');
                    //     })
                    //     .catch(error => {
                    //         console.error('Service Worker registration failed:', error);

                    //         // Notify the main domain of failure
                    //         window.opener.postMessage({ action: 'subscriptionFailed' }, 'https://bookmylivestock.com');
                    //     });
                } else {
                    console.log('Notification permission denied.');
                    // Notify the main domain of failure
                    window.opener.postMessage({ action: 'subscriptionFailed' }, 'https://www.bookmylivestock.com');
                }
            });
        });
    </script>
</body>
</html>
